// Package vulnerability provides functionality for vulnerability toolset.
package vulnerability

import (
	"github.com/stackrox/stackrox-mcp/internal/client"
	"github.com/stackrox/stackrox-mcp/internal/config"
	"github.com/stackrox/stackrox-mcp/internal/toolsets"
)

// Toolset implements the vulnerability management toolset.
type Toolset struct {
	cfg   *config.Config
	tools []toolsets.Tool
}

// NewToolset creates a new vulnerability management toolset.
func NewToolset(cfg *config.Config, c *client.Client) *Toolset {
	return &Toolset{
		cfg: cfg,
		tools: []toolsets.Tool{
			NewGetDeploymentsForCVETool(c),
		},
	}
}

// GetName returns the toolset name.
func (t *Toolset) GetName() string {
	return "vulnerability"
}

// IsEnabled checks if this toolset is enabled in configuration.
func (t *Toolset) IsEnabled() bool {
	return t.cfg.Tools.Vulnerability.Enabled
}

// GetTools returns all tools.
func (t *Toolset) GetTools() []toolsets.Tool {
	if !t.IsEnabled() {
		return []toolsets.Tool{}
	}

	return t.tools
}
